<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    <title>
        
        基于 vue 全家桶的 spa 项目模板 |
        
        安·记</title>
    <script>
        if (location.host.indexOf('cssha.com') >= 0) {
            location.href = location.href.replace('cssha.com', 'annn.me');
        }
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta property="wb:webmaster" content="35db845a3f9d1692"/>
    <meta name="baidu-site-verification" content="VdeWu2EHCz"/>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache, must-revalidate">
    <meta name="description" content="项目简介Github: https://github.com/annnhan/vue-spa-template 最近在给团队做前端技术改造，移动端方面主要使用 vue2.0 重构，这是基于 vue-cli 脚手架生成项目模板。我们做了一些改造，加入了 vue-router ，vuex 等配套设施，本地 dev server 中加入了接口 mock 功能，还增加一个 build server 来预览">
<meta name="keywords" content="vue.js,spa,vuex,vue-router">
<meta property="og:type" content="article">
<meta property="og:title" content="基于 vue 全家桶的 spa 项目模板">
<meta property="og:url" content="http://annn.me/vue-spa-template/index.html">
<meta property="og:site_name" content="安·记">
<meta property="og:description" content="项目简介Github: https://github.com/annnhan/vue-spa-template 最近在给团队做前端技术改造，移动端方面主要使用 vue2.0 重构，这是基于 vue-cli 脚手架生成项目模板。我们做了一些改造，加入了 vue-router ，vuex 等配套设施，本地 dev server 中加入了接口 mock 功能，还增加一个 build server 来预览">
<meta property="og:updated_time" content="2017-05-08T08:55:03.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="基于 vue 全家桶的 spa 项目模板">
<meta name="twitter:description" content="项目简介Github: https://github.com/annnhan/vue-spa-template 最近在给团队做前端技术改造，移动端方面主要使用 vue2.0 重构，这是基于 vue-cli 脚手架生成项目模板。我们做了一些改造，加入了 vue-router ，vuex 等配套设施，本地 dev server 中加入了接口 mock 功能，还增加一个 build server 来预览">
    
    <link rel="alternative" href="/atom.xml" title="安·记" type="application/rss+xm">
    
    
    <link rel="icon" href="/favicon.ico">
    
    <link href="/css/fonts/source-code-pro.woff2" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/css/style.css">
    
<!--百度统计-->
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?3e1fabf44865ddfe8b31fa9d84cbe4c9";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <!--<div id="header-title" class="inner">-->
      <!--<h1 id="logo-wrap">-->
        <!--<a href="/" id="logo">安·记</a>-->
      <!--</h1>-->
      <!---->
    <!--</div>-->
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        <h1 class="main-nav-link"><a href="/">安·记</a></h1>
        
          
          <a class="main-nav-link" href="/archives" target="">归档</a>
        
          
          <a class="main-nav-link" href="/categories" target="">分类</a>
        
          
          <a class="main-nav-link" href="/tags" target="">标签</a>
        
          
          <a class="main-nav-link" href="/links" target="">链接</a>
        
          
          <a class="main-nav-link" href="https://500px.com/annnhan" target="_blank">摄影</a>
        
          
          <a class="main-nav-link" href="/about" target="">关于</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://annn.me"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-vue-spa-template" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/vue-spa-template/" class="article-date">
  <time datetime="2016-10-29T14:23:09.000Z" itemprop="datePublished">2016-10-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categorie/javascript/">javascript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h2 class="article-title" itemprop="name">
      基于 vue 全家桶的 spa 项目模板
    </h2>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="项目简介"><a href="#项目简介" class="headerlink" title="项目简介"></a>项目简介</h2><p>Github: <a href="https://github.com/annnhan/vue-spa-template" target="_blank">https://github.com/annnhan/vue-spa-template</a></p>
<p>最近在给团队做前端技术改造，移动端方面主要使用 vue2.0 重构，这是基于 vue-cli 脚手架生成项目模板。我们做了一些改造，<br>加入了 vue-router ，vuex 等配套设施，本地 dev server 中加入了接口 mock 功能，还增加一个 build server 来预览 build 结果页面，前后端通过 spa 的方式实现分离，并相应做了分离后的联调，部署方案。<br>通过这个项目模板，可以快速搭建起用于前后端分离后的单页应用开发环境，项目主要包含：</p>
<ul>
<li>基础库: <code>vue.js</code>、<code>vue-router</code>、<code>vuex</code>、<code>whatwg-fetch</code></li>
<li>编译/打包工具：<code>webpack</code>、<code>babel</code>、<code>node-sass</code></li>
<li>单元测试工具：<code>karma</code>、<code>mocha</code>、<code>sinon-chai</code></li>
<li>本地服务器：<code>express</code></li>
</ul>
<a id="more"></a>
<h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><pre><code>├── README.md                       项目介绍
├── index.html                      入口页面
├── build                           构建脚本目录
│   ├── build-server.js                 运行本地构建服务器，可以访问构建后的页面
│   ├── build.js                        生产环境构建脚本
│   ├── dev-client.js                   开发服务器热重载脚本，主要用来实现开发阶段的页面自动刷新
│   ├── dev-server.js                   运行本地开发服务器
│   ├── utils.js                        构建相关工具方法
│   ├── webpack.base.conf.js            wabpack基础配置
│   ├── webpack.dev.conf.js             wabpack开发环境配置
│   └── webpack.prod.conf.js            wabpack生产环境配置
├── config                          项目配置
│   ├── dev.env.js                      开发环境变量
│   ├── index.js                        项目配置文件
│   ├── prod.env.js                     生产环境变量
│   └── test.env.js                     测试环境变量
├── mock                            mock数据目录
│   └── hello.js
├── package.json                    npm包配置文件，里面定义了项目的npm脚本，依赖包等信息
├── src                             源码目录
│   ├── main.js                         入口js文件
│   ├── app.vue                         根组件
│   ├── components                      公共组件目录
│   │   └── title.vue
│   ├── assets                          资源目录，这里的资源会被wabpack构建
│   │   └── images
│   │       └── logo.png
│   ├── routes                          前端路由
│   │   └── index.js
│   ├── store                           应用级数据（state）
│   │   └── index.js
│   └── views                           页面目录
│       ├── hello.vue
│       └── notfound.vue
├── static                          纯静态资源，不会被wabpack构建。
└── test                            测试文件目录（unit&amp;e2e）
    └── unit                            单元测试
        ├── index.js                        入口脚本
        ├── karma.conf.js                   karma配置文件
        └── specs                           单测case目录
            └── Hello.spec.js
</code></pre><h2 id="环境安装"><a href="#环境安装" class="headerlink" title="环境安装"></a>环境安装</h2><p>本项目依赖 node.js， 使用前先安装 node.js 和 cnpm（显著提升依赖包的下载速度）。</p>
<ol>
<li>自行下载并安装 node.js： <a href="https://nodejs.org/en/download/" target="_blank" rel="external">https://nodejs.org/en/download/</a></li>
<li><p>然后安装 cnpm 命令：</p>
<pre><code>npm install -g cnpm --registry=https://registry.npm.taobao.org
</code></pre></li>
</ol>
<h2 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h2><pre><code>git clone https://github.com/hanan198501/vue-spa-template.git
cd vue-spa-template
cnpm install
npm run dev
</code></pre><h2 id="命令列表："><a href="#命令列表：" class="headerlink" title="命令列表："></a>命令列表：</h2><pre><code>#开启本地开发服务器，监控项目文件的变化，实时构建并自动刷新浏览器，浏览器访问 http://localhost:8081
npm run dev

#使用生产环境配置构建项目，构建好的文件会输出到 &quot;dist&quot; 目录，
npm run build

#运行构建服务器，可以查看构建的页面
npm run build-server

#运行单元测试
npm run unit
</code></pre><h2 id="前后端分离"><a href="#前后端分离" class="headerlink" title="前后端分离"></a>前后端分离</h2><p>项目基于 spa 方式实现前后端分离，后端将所有 url 都返回到同一个 jsp 页面（由前端提供），此 jsp 页面也是前端的入口页面。然后路由由前端控制（基于vue-router），根据不同的 url 加载相应数据和组件进行渲染。</p>
<h2 id="接口-mock"><a href="#接口-mock" class="headerlink" title="接口 mock"></a>接口 mock</h2><p>前后端分离后，开发前需要和后端同学定义好接口信息（请求地址，参数，返回信息等），前端通过 mock 的方式，即可开始编码，无需等待后端接口 ready。<br>项目的本地开发服务器是基于 express 搭建的，通过 express 的中间件机制，我们已经在 dev-server 中添加了接口 mock 功能。<br>开发时，接口的 mock 数据统一放在 mock 目录下，每个文件内如下：</p>
<pre><code>module.exports = {

  // 接口地址
  api: &apos;/api/hello&apos;,

  // 返回数据 参考http://expressjs.com/zh-cn/4x/api.html
  response: function (req, res) {
    res.send(`
      &lt;p&gt;hello vue!&lt;/p&gt;
    `);
  }
}
</code></pre><h2 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h2><p>开发时可以使用 ES2015 module 语法，构建时每个文件会编译成 amd 模块。</p>
<h2 id="组件化"><a href="#组件化" class="headerlink" title="组件化"></a>组件化</h2><p>整个应用通过 vue 组件的方式搭建起来，通过 vue-router 控制相应组件的展现，组件树结构如下：</p>
<pre><code>app.vue                         根组件（整个应用只有一个）
    ├──view1.vue                    页面级组件，放在 views 目录里面，有子组件时，可以建立子目录
    │   ├──component1.vue               功能组件，公用的放在 components 目录，否则放在 views 子目录
    │   ├──component2.vue
    │   └──component3.vue
    ├──view2.vue
    │   ├──component1.vue
    │   └──component4.vue
    └──view3.vue
        ├──component5.vue
        ……
</code></pre><h2 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h2><p>可以为每个组件编写单元测试，放在 <code>test/unit/specs</code> 目录下面, 单元测试用例的目录结构建议和测试的文件保持一致（相对于src），每个测试用例文件名以 <code>.spec.js</code>结尾。<br>执行 <code>npm run unit</code> 时会遍历所有的 <code>spec.js</code> 文件，产出测试报告在 <code>test/unit/coverage</code> 目录。</p>
<h2 id="联调方式"><a href="#联调方式" class="headerlink" title="联调方式"></a>联调方式</h2><p>前后端分离后，由于服务端和前端的开发环境处于2台不同的机器上，前端的异步请求需要代理到后端机器中。<br>联调的时候，只需通过 proxy 参数运行 dev 脚本即可，所有 mock 目录下定义的接口将会转发到 proxy 参数指定的机器：</p>
<pre><code># 172.16.36.90：8083 为后端机器的环境地址
npm run dev -- --proxy=172.16.36.90/:8083
</code></pre><p>这样，如果 mock 目录下有定义了接口 /api/hello ，将会转发到 <a href="http://172.16.36.90/:8083/api/hello" target="_blank" rel="external">http://172.16.36.90/:8083/api/hello</a></p>
<h2 id="部署方案"><a href="#部署方案" class="headerlink" title="部署方案"></a>部署方案</h2><p>分离后前后端代码会存放在2个单独的 git 仓库中，构建过程也是分开的。后端构建时，需要依赖前端的构建结果。具体流程如下：</p>
<ol>
<li>pull 前端项目代码</li>
<li>构建前端（构建结果放在dist目录）</li>
<li>pull 后端代码</li>
<li>将前端的构建结果（dist目录里的文件）复制到后端工程中</li>
<li>构建后端</li>
</ol>
<p>提测时，此过程可以借助 jenkins 配置。上线时，需要运维同学配合修改上线脚本。</p>
<h2 id="相关资源"><a href="#相关资源" class="headerlink" title="相关资源"></a>相关资源</h2><ul>
<li>vue.js 官网：<a href="https://vuejs.org/" target="_blank" rel="external">https://vuejs.org/</a></li>
<li>vue.js 中文网： <a href="http://vuefe.cn/" target="_blank" rel="external">http://vuefe.cn/</a></li>
<li>vue-router 文档：<a href="http://router.vuejs.org/zh-cn/index.html" target="_blank" rel="external">http://router.vuejs.org/zh-cn/index.html/</a></li>
<li>vuex 文档：<a href="http://vuex.vuejs.org/" target="_blank" rel="external">http://vuex.vuejs.org/</a></li>
<li>webpack 文档：<a href="https://webpack.github.io/docs/" target="_blank" rel="external">https://webpack.github.io/docs/</a></li>
<li>ES2015 入门教程：<a href="http://es6.ruanyifeng.com/" target="_blank" rel="external">http://es6.ruanyifeng.com/</a></li>
<li>scss 文档：<a href="http://sass-lang.com/documentation/file.SASS_REFERENCE.html" target="_blank" rel="external">http://sass-lang.com/documentation/file.SASS_REFERENCE.html</a></li>
<li>mocha 文档: <a href="http://mochajs.org/" target="_blank" rel="external">http://mochajs.org/</a></li>
<li>express 中文官网：<a href="http://expressjs.com/zh-cn/" target="_blank" rel="external">http://expressjs.com/zh-cn/</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://annn.me/vue-spa-template/" data-id="cj2fw62ll007af2fy3uq0bsm0" data-title="基于 vue 全家桶的 spa 项目模板" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/spa/">spa</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/vue-router/">vue-router</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/vue-js/">vue.js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/vuex/">vuex</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/frontend-ci-cd/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          前端开发如何让持续集成/持续部署(CI/CD)跑起来
        
      </div>
    </a>
  
  
    <a href="/javascript-nginx/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">使用 javascript 配置 nginx</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <div id="comments-containet"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
  var gitment = new Gitment({
    owner: 'annnhan',
    repo: window.githubRepository || 'gitment',
    oauth: {
      client_id: '0a05c848f85cc4fdc815',
      client_secret: '6bfdb7c41012f8b3d28935e7e08b8e6c1504a325',
    },
  })
  gitment.render('comments-containet')
</script>
  </div>
</section>
</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 阿安<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/categories" class="mobile-nav-link">分类</a>
  
    <a href="/tags" class="mobile-nav-link">标签</a>
  
    <a href="/links" class="mobile-nav-link">链接</a>
  
    <a href="https://500px.com/annnhan" class="mobile-nav-link">摄影</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
</nav>
    

<!--<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>-->

<script src="/js/libs/jquery.2.0.3.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>