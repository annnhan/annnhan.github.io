<!DOCTYPE html>
<html>
<head>
    <script src="https://og6593g2z.qnssl.com/fundebug.0.3.3.min.js" apikey="e4ebd1d8446798b665fed4258ebd75f1ee7489bda0832a94b9d5f2a6d07d2f4b"></script>
    <meta charset="utf-8">
    
    <title>
        
        安·记</title>
    <script>
        if (location.host.indexOf('cssha.com') >= 0) {
            location.href = location.href.replace('cssha.com', 'annn.me');
        }
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta property="wb:webmaster" content="35db845a3f9d1692"/>
    <meta name="baidu-site-verification" content="VdeWu2EHCz"/>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache, must-revalidate">
    <meta name="description" content="阿安的Blog">
<meta property="og:type" content="website">
<meta property="og:title" content="安·记">
<meta property="og:url" content="http://annn.me/index.html">
<meta property="og:site_name" content="安·记">
<meta property="og:description" content="阿安的Blog">
<meta property="og:locale" content="zh-cn">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="安·记">
<meta name="twitter:description" content="阿安的Blog">
    
    <link rel="alternative" href="/atom.xml" title="安·记" type="application/rss+xm">
    
    
    <link rel="icon" href="/favicon.ico">
    
    <link href="/css/fonts/source-code-pro.woff2" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/css/style.css">
    
<!--百度统计-->
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?3e1fabf44865ddfe8b31fa9d84cbe4c9";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <!--<div id="header-title" class="inner">-->
      <!--<h1 id="logo-wrap">-->
        <!--<a href="/" id="logo">安·记</a>-->
      <!--</h1>-->
      <!---->
    <!--</div>-->
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        <h1 class="main-nav-link"><a href="/">安·记</a></h1>
        
          
          <a class="main-nav-link" href="/archives" target="">归档</a>
        
          
          <a class="main-nav-link" href="/categories" target="">分类</a>
        
          
          <a class="main-nav-link" href="/tags" target="">标签</a>
        
          
          <a class="main-nav-link" href="/links" target="">链接</a>
        
          
          <a class="main-nav-link" href="https://500px.com/annnhan" target="_blank">摄影</a>
        
          
          <a class="main-nav-link" href="/about" target="">关于</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://annn.me"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">

  <!--首页-->
  
    
    <article id="post-implement-a-programming-language-5" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/implement-a-programming-language-5/" class="article-date">
  <time datetime="2018-03-22T02:00:02.000Z" itemprop="datePublished">2018-03-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categorie/javascript/">javascript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/implement-a-programming-language-5/">如何使用 JavaScript 实现一门编程语言(5) —— AST</a>
    </h2>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在计算机科学中，抽象语法树（Abstract Syntax Tree，AST），或简称语法树（Syntax tree），是源代码语法结构的一种抽象表示。它以树状的形式表现编程语言的语法结构，树上的每个节点都表示源代码中的一种结构。</p>
<p>之前我们讲过，parser将构建一个忠实地表示程序语义的数据结构。这里的AST节点则是一个普通的JavaScript对象，它具有一个type属性，用于指定它是什么类型的节点，还有一些附加信息，附加信息的值可能因 type 而异。</p>
<p>下面是我们语言所有 AST 节点列表：</p>
        
          <p class="article-more-link">
            <a href="/implement-a-programming-language-5/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://annn.me/implement-a-programming-language-5/" data-id="cjf2fw26e0041hwf5ux6mrf3w" data-title="如何使用 JavaScript 实现一门编程语言(5) —— AST" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/AST/">AST</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/compile/">compile</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/language/">language</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/parse/">parse</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/programming/">programming</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/编译原理/">编译原理</a></li></ul>

    </footer>
  </div>
  
</article>


  
    
    <article id="post-implement-a-programming-language-4" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/implement-a-programming-language-4/" class="article-date">
  <time datetime="2018-03-22T02:00:01.000Z" itemprop="datePublished">2018-03-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categorie/javascript/">javascript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/implement-a-programming-language-4/">如何使用 JavaScript 实现一门编程语言(4) —— Token stream</a>
    </h2>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>tokenizer(标记器, 也称为“词法分析器”), 对 <a href="/implement-a-programming-language-3">字符输入流</a> 进行操作，并返回具有相同接口的流对象，但由 peek()/next() 返回的值一个个token。token是具有两个属性的对象：type和value。以下是我们所支持的token的一些示例：</p>
<pre><code>{  type：“ punc ”，value：“ （”  }            // 标点符号：parens，逗号，分号等等
{  type：“ num ”，value：5  }               // numbers
{  type：“ str ”，value：“ Hello World ！“  }  // 字符串
{  type：” kw “，value：”lambda “  }         // keywords
{  type： ” var “， value： ” a “  }             // 标识符
{  type： ” op “， value： ” ！= “  }             // 运算符
</code></pre><p>空白符和注释将被跳过，没有令牌返回。</p>
<p>为了编写tokenizer，我们需要更仔细地认识我们的语言的语法。有个办法是，根据当前字符（由input.peek()返回的）来决定读取哪种类型的token：</p>
<ol>
<li>首先，跳过空格。</li>
<li>如果然后返回。input.eof()null</li>
<li>如果它是一个井号（#），则跳过注释（在行结束后重试）。</li>
<li>如果它是一个引号，那么阅读一个字符串。</li>
<li>如果它是一个数字，那么我们继续阅读一个数字。</li>
<li>如果它是“字母”，则读取标识符或关键字token。</li>
<li>如果它是标点符号之一，则返回标点符号token。</li>
<li>如果它是运算符，则返回运算符token。</li>
<li>如果以上都不是，那就抛出错误了。input.croak()</li>
</ol>
<p>“read_next”函数作为tokenizer的核心部分 ，它实现了上面的内容：</p>
        
          <p class="article-more-link">
            <a href="/implement-a-programming-language-4/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://annn.me/implement-a-programming-language-4/" data-id="cjf2fw26d003yhwf5vx7i5p8u" data-title="如何使用 JavaScript 实现一门编程语言(4) —— Token stream" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/AST/">AST</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/compile/">compile</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/language/">language</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/parse/">parse</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/programming/">programming</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/编译原理/">编译原理</a></li></ul>

    </footer>
  </div>
  
</article>


  
    
    <article id="post-implement-a-programming-language-3" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/implement-a-programming-language-3/" class="article-date">
  <time datetime="2018-03-22T02:00:00.000Z" itemprop="datePublished">2018-03-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categorie/javascript/">javascript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/implement-a-programming-language-3/">如何使用 JavaScript 实现一门编程语言(3) —— Input stream</a>
    </h2>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>这是最简单的部分。我们将创建一个“流对象”，它提供了从字符串中读取字符的操作。其中4个方法：</p>
<ul>
<li>peek() - 返回下一个值，但不从流中移除它。</li>
<li>next() - 返回下一个值，并将其从流中丢弃。</li>
<li>eof() - 当且仅当流中没有更多值时才返回true。</li>
<li>croak(msg) - throw new Error(msg)</li>
</ul>
<p>之所以包括最后一个，是因为流可以很容易地跟踪当前位置（即行/列），这对于显示错误消息很重要。</p>
<p>您可以根据您的需求随意添加更多的方法在流对象中，但对于我的教程这些就足够了。</p>
<p>因为流对象主要用来处理字符，所以 next()/ peek() 方法返回的值也是字符（JS没有char类型，它们是包含一个单一字符的字符串）。</p>
        
          <p class="article-more-link">
            <a href="/implement-a-programming-language-3/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://annn.me/implement-a-programming-language-3/" data-id="cjf2fw26c003whwf5vl11z1w8" data-title="如何使用 JavaScript 实现一门编程语言(3) —— Input stream" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/AST/">AST</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/compile/">compile</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/language/">language</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/parse/">parse</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/programming/">programming</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/编译原理/">编译原理</a></li></ul>

    </footer>
  </div>
  
</article>


  
    
    <article id="post-implement-a-programming-language-2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/implement-a-programming-language-2/" class="article-date">
  <time datetime="2018-03-20T16:00:00.000Z" itemprop="datePublished">2018-03-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categorie/javascript/">javascript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/implement-a-programming-language-2/">如何使用 JavaScript 实现一门编程语言(2) —— 编写一个解析器</a>
    </h2>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>编写语言解析器是一项适度复杂的任务。实质上，它必须将一段代码（我们所看到的一堆字符）转换为“抽象语法树”（AST）。<br>AST是程序在内存中一种结构化的表达方式，它是“抽象”的，因为它不关心源代码是由哪些字符组成的，而是忠实地表示它的语义。我写了一个单独的页面来描述我们的AST。</p>
<p>例如，对于以下程序文本：</p>
<pre><code>sum = lambda(a, b) {
  a + b;
};
print(sum(1, 2));
</code></pre>
        
          <p class="article-more-link">
            <a href="/implement-a-programming-language-2/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://annn.me/implement-a-programming-language-2/" data-id="cjf2fw26a003thwf5yhs63sp7" data-title="如何使用 JavaScript 实现一门编程语言(2) —— 编写一个解析器" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/AST/">AST</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/compile/">compile</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/language/">language</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/parse/">parse</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/programming/">programming</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/编译原理/">编译原理</a></li></ul>

    </footer>
  </div>
  
</article>


  
    
    <article id="post-implement-a-programming-language" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/implement-a-programming-language/" class="article-date">
  <time datetime="2018-03-15T16:00:00.000Z" itemprop="datePublished">2018-03-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categorie/javascript/">javascript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/implement-a-programming-language/">如何使用 JavaScript 实现一门编程语言(1) —— 前言</a>
    </h2>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>这是一系列关于 <a href="/tag/编译原理">如何实现编程语言</a> 的教程。如果你曾经写过一个解释器或编译器，那么这里可能没有什么新东西。但是，如果您使用正则表达式来“解析” 任何看起来像编程语言的东西，那么请至少阅读解析部分。让我们写出更少的错误代码！</p>
<p>目标受众是普通的 JavaScript / NodeJS 程序员。</p>
<p>我们要学什么？</p>
<ul>
<li>什么是解析器，以及如何编写解析器。</li>
<li>如何编写解释器。</li>
<li>为什么它们很重要。</li>
<li>编写一个编译器。</li>
<li>如何将代码转换为延续传递样式。</li>
<li>一些基本的优化技术。</li>
</ul>
<p>在两者之间，我会争论为什么 Lisp 是一种优秀的编程语言。 但是，我们将要使用的语言不是 Lisp。它有一个更丰富的语法（每个人都知道的经典中缀符号），除宏之外，它的功能与 Scheme相当。<br>可悲的是，宏是 Lisp 的最终堡垒，其他语言无法克服（除非它们被称为 Lisp 方言）。</p>
<h3 id="首先，让我们想想我们的要实现的编程语言应该是什么样子。"><a href="#首先，让我们想想我们的要实现的编程语言应该是什么样子。" class="headerlink" title="首先，让我们想想我们的要实现的编程语言应该是什么样子。"></a>首先，让我们想想我们的要实现的编程语言应该是什么样子。</h3><p>我们应该想清楚自己想要实现的目标。把语法的严格描述放在一起是一个好主意，但是我会在本教程中使语法更加简单，下面的示例就是我们要实现 “λ” 语言：</p>
<pre><code># this is a comment

println(&quot;Hello World!&quot;);

println(2 + 3 * 4);

# functions are introduced with `lambda` or `λ`
fib = lambda (n) if n &lt; 2 then n else fib(n - 1) + fib(n - 2);

println(fib(15));

print-range = λ(a, b)             # `λ` is synonym to `lambda`
                if a &lt;= b then {  # `then` here is optional as you can see below
                  print(a);
                  if a + 1 &lt;= b {
                    print(&quot;, &quot;);
                    print-range(a + 1, b);
                  } else println(&quot;&quot;);        # newline
                };
print-range(1, 5);
</code></pre><p><em>请注意，标识符名称可以包含负号字符（print-range）。这是个人品味的问题：我总是在操作符旁边放置空格，我不喜欢太多的 camelCaseNames，而且我觉得短划线比下划线更好。编写自己的语言的好处是，你可以随心所欲地做到这一点。:)</em></p>
<p>输出是：</p>
<pre><code>Hello World!
14
610
1, 2, 3, 4, 5
</code></pre>
        
          <p class="article-more-link">
            <a href="/implement-a-programming-language/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://annn.me/implement-a-programming-language/" data-id="cjf2fw26g0043hwf56caskrfw" data-title="如何使用 JavaScript 实现一门编程语言(1) —— 前言" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/AST/">AST</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/compile/">compile</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/language/">language</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/parse/">parse</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/programming/">programming</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/编译原理/">编译原理</a></li></ul>

    </footer>
  </div>
  
</article>


  
    
    <article id="post-frontend-ci-cd" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/frontend-ci-cd/" class="article-date">
  <time datetime="2017-05-02T16:00:00.000Z" itemprop="datePublished">2017-05-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categorie/javascript/">javascript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/frontend-ci-cd/">前端开发如何让持续集成/持续部署(CI/CD)跑起来</a>
    </h2>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>近几年，伴随着前端技术日新月异的发展，前端开发中前后端分离，工程化，自动化等现代化的开发模式越来普及，前端项目也引入了编译，构建，单元测试等现代软件工程化的标准环节。这样大提高了前端的开发效率和业务交付能力。但是，在代码集成，项目部署阶段，我们还需要引入 <a href="https://en.wikipedia.org/wiki/Continuous_integration" target="_blank" rel="noopener">CI</a> / <a href="https://en.wikipedia.org/wiki/Continuous_delivery" target="_blank" rel="noopener">CD</a> 等现代化的软件开发实践，来减少风险，重复过程，节省我们的时间。</p>
<p>我们废话少说，这里不再对 持续集成/持续部署(CI/CD) 的概念做过多赘述，本文主要分享一下如何基于 <a href="https://about.gitlab.com/" target="_blank" rel="noopener">gitlab</a> 、 <a href="https://jenkins.io/" target="_blank" rel="noopener">jenkins</a> 让 CI/CD 跑起来。</p>
<p>其中：</p>
<ul>
<li>gitlab 用于代码版本管理，并通过其提供的 webhook 功能，触发 jenkins job 的运行。</li>
<li>jenkins 用来执行项目中 单元测试，编译打包相关 npm 命令，并发送反馈邮件，执行远程部署脚本。</li>
<li>nodejs 用于提供单元测试，编译打包功能的 npm 命令</li>
</ul>
<p>在我们的前端项目里（如： <a href="https://github.com/hanan198501/vue-spa-template" target="_blank" rel="noopener">https://github.com/hanan198501/vue-spa-template</a> ），一般使用 karma 来运行单元测试，使用 webpack 来进行打包构建， 使用 npm script 来执行这些任务，其中我们的 package.json 的 scripts 字段就有如下：</p>
<pre><code>&quot;dev&quot;: &quot;node build/dev-server.js&quot;,
&quot;build&quot;: &quot;node build/build.js&quot;, //打包构建
&quot;build-server&quot;: &quot;node build/build-server.js&quot;,
&quot;unit&quot;: &quot;karma start test/unit/karma.conf.js --single-run&quot;, // 运行单元测试
</code></pre><h3 id="如果没有-CI-CD，-我们的前端从开发到提测工作流程可能如下："><a href="#如果没有-CI-CD，-我们的前端从开发到提测工作流程可能如下：" class="headerlink" title="如果没有 CI/CD， 我们的前端从开发到提测工作流程可能如下："></a>如果没有 CI/CD， 我们的前端从开发到提测工作流程可能如下：</h3><ol>
<li>本地机器上写代码</li>
<li>在命令行输入 npm run unit，查看单元测试结果</li>
<li>提交代码，push 到 git 远程仓库</li>
<li>登录测试服务器，拉取代码，执行 npm run build，构建项目</li>
<li>如果测试服务器是基于 pm2 的 proxy server，还需要重启 server</li>
</ol>
<p>这个流程中，每一个步骤都要重复人工操作，很大增加了时间成本，不能保证操作的准确性。对于 unit 或者 build 的结果，没有一个自动的反馈机制，需要人工 check 运行结果，最后部署也是人工登录服务器执行脚本，非常繁琐。</p>
<h3 id="引入-CI-CD-以后，整个流程变成："><a href="#引入-CI-CD-以后，整个流程变成：" class="headerlink" title="引入 CI/CD 以后，整个流程变成："></a>引入 CI/CD 以后，整个流程变成：</h3><ol>
<li>本地机器上写代码</li>
<li>提交代码，push 到 git 远程仓库</li>
<li>git hook 触发 jenkins 的构建 job （自动）</li>
<li>jenkins job 中拉取项目代码，运行 npm run unit 和 npm run build，如果失败，发送邮件通知相关人。（自动）</li>
<li>jenkins job 中执行测试服务器的部署脚本 （自动）</li>
</ol>
<p>在 CI/CD 流程中，只有步骤1和步骤2需要人工操作，其他步骤都是自动运行，是一个非常标准化的流程，减少了人工操作的风险，省去了重复性工作，增强了项目的可见性。接下来我们将通过配置 jenkins 和 gitlab webhook 来实现这个流程。</p>
        
          <p class="article-more-link">
            <a href="/frontend-ci-cd/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://annn.me/frontend-ci-cd/" data-id="cjf2fw25s002jhwf5t3kw3l67" data-title="前端开发如何让持续集成/持续部署(CI/CD)跑起来" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/CD/">CD</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/gitlab/">gitlab</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/jenkins/">jenkins</a></li></ul>

    </footer>
  </div>
  
</article>


  
    
    <article id="post-vue-spa-template" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/vue-spa-template/" class="article-date">
  <time datetime="2016-10-29T14:23:09.000Z" itemprop="datePublished">2016-10-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categorie/javascript/">javascript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/vue-spa-template/">基于 vue 全家桶的 spa 项目模板</a>
    </h2>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="项目简介"><a href="#项目简介" class="headerlink" title="项目简介"></a>项目简介</h2><p>Github: <a href="https://github.com/annnhan/vue-spa-template" target="_blank">https://github.com/annnhan/vue-spa-template</a></p>
<p>最近在给团队做前端技术改造，移动端方面主要使用 vue2.0 重构，这是基于 vue-cli 脚手架生成项目模板。我们做了一些改造，<br>加入了 vue-router ，vuex 等配套设施，本地 dev server 中加入了接口 mock 功能，还增加一个 build server 来预览 build 结果页面，前后端通过 spa 的方式实现分离，并相应做了分离后的联调，部署方案。<br>通过这个项目模板，可以快速搭建起用于前后端分离后的单页应用开发环境，项目主要包含：</p>
<ul>
<li>基础库: <code>vue.js</code>、<code>vue-router</code>、<code>vuex</code>、<code>whatwg-fetch</code></li>
<li>编译/打包工具：<code>webpack</code>、<code>babel</code>、<code>node-sass</code></li>
<li>单元测试工具：<code>karma</code>、<code>mocha</code>、<code>sinon-chai</code></li>
<li>本地服务器：<code>express</code></li>
</ul>
        
          <p class="article-more-link">
            <a href="/vue-spa-template/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://annn.me/vue-spa-template/" data-id="cjf2fw28f007phwf5u481h2ni" data-title="基于 vue 全家桶的 spa 项目模板" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/spa/">spa</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/vue-router/">vue-router</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/vue-js/">vue.js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/vuex/">vuex</a></li></ul>

    </footer>
  </div>
  
</article>


  
    
    <article id="post-javascript-nginx" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/javascript-nginx/" class="article-date">
  <time datetime="2015-10-01T07:33:41.000Z" itemprop="datePublished">2015-10-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categorie/javascript/">javascript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/javascript-nginx/">使用 javascript 配置 nginx</a>
    </h2>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在上个月的 nginx.conf 2015 大会上， 官方宣布已经支持通过 javascript 代码来配置 nginx，并把这个实现称命名为——nginscript。使用 nginscript，可以很轻易得在 niginx 配置文件中通过 js 语法来实现自定义的服务器配置。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><pre><code># 下载最新版本的 nginx 并解压
curl -O http://nginx.org/download/nginx-1.9.5.tar.gz
tar -xzvf nginx-1.9.5.tar.gz

# 下载 nginscript 模块并解压
curl -O http://hg.nginx.org/njs/archive/tip.tar.gz
tar -xzvf tip.tar.gz

# 编译并安装 nginx
$ cd nginx-1.9.5
$ ./configure --add-module=刚才解压的nginscript目录
$ make
$ make install
</code></pre>
        
          <p class="article-more-link">
            <a href="/javascript-nginx/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://annn.me/javascript-nginx/" data-id="cjf2fw26t004rhwf5yg2ibj8q" data-title="使用 javascript 配置 nginx" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/nginx/">nginx</a></li></ul>

    </footer>
  </div>
  
</article>


  
    
    <article id="post-reres-googleapis" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/reres-googleapis/" class="article-date">
  <time datetime="2015-09-11T05:22:51.000Z" itemprop="datePublished">2015-09-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categorie/javascript/">javascript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/reres-googleapis/">无梯子如何正常访问使用了 googleapis 的网站</a>
    </h2>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>许多国外的网站都使用被墙掉的 googleapis.com 上的静态资源（如 font、js库 等），如果不爬墙，这些资源无法加载，导致网站无法正常访问。</p>
<p>其实，360提供了一个国内的 googleapis.com 镜像仓库（<a href="http://libs.useso.com/" target="_blank" rel="noopener">libs.useso.com</a>）。我想，当遇到 googleapis 的请求时，浏览器能自动跳转到360的镜像，就能正常访问了。</p>
<p>正好，我以前写过一个 chrome 插件 <a href="https://github.com/hanan198501/ReRes" target="_blank" rel="noopener">ReRes</a>，可以通过它来完成这项工作。</p>
<p>安装好 ReRes 后，添加一条规则：</p>
<pre><code>If URL match：^http\:\/\/(.+?)\.googleapis\.com\/(.+?)$
Response：http://$1.useso.com/$2
</code></pre><p>当浏览器中的请求匹配到 ^http\:\/\/(.+?).googleapis.com\/(.+?)$ 这个正则时，会自动跳转到 http://$1.useso.com/$2 这个 url ，其中 $1 和 $2 分别是正则中捕获到的两个分组。</p>
<p>如此，就可以正常访问使用了 googleapis 的网站。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://annn.me/reres-googleapis/" data-id="cjf2fw27m006hhwf5hl46yh8v" data-title="无梯子如何正常访问使用了 googleapis 的网站" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/ReRes/">ReRes</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/googleapis/">googleapis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    
    <article id="post-how-to-realize-cmd-loader" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/how-to-realize-cmd-loader/" class="article-date">
  <time datetime="2015-09-03T09:03:00.000Z" itemprop="datePublished">2015-09-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categorie/javascript/">javascript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/how-to-realize-cmd-loader/">如何实现一个 CMD 模块加载器</a>
    </h2>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>cmd 是阿里大神玉伯提出的基于浏览器的前端模块化规范，并在 seajs 中实现了这个规范。相对于另一个在国外比较流行的前端模块化规范 amd，cmd 对于 nodejs 的使用者来说更加友好，使得类似 commonJS 模块的写法可以在浏览器中使用，同时解决了浏览器中模块异步加载的困扰。<br>关于 cmd 更详细的内容可以移步 <a href="https://github.com/cmdjs/specification/blob/master/draft/module.md" target="_blank" rel="noopener">https://github.com/cmdjs/specification/blob/master/draft/module.md</a><br>今天，我们一起来学习如何实现一个浏览器端的简单的 cmd loader。</p>
<h2 id="模块加载流程"><a href="#模块加载流程" class="headerlink" title="模块加载流程"></a>模块加载流程</h2><p>下图展示了一个 cmd loader 的模块加载大体流程：</p>
<p><img src="/assets/img/cmd.png" alt="cmd loader"></p>
<ol>
<li>首先，通过 use 方法来加载入口模块，并接收一个回调函数， 当模块加载完成， 会调用回调函数，并传入对应的模块。use 方法会 check 模块有没有缓存，如果有，则从缓存中获取模块，如果没有，则创建并加载模块。</li>
<li>获取到模块后，模块可能还没有 load 完成，所以需要在模块上绑定一个 “complete” 事件，模块加载完成会触发这个事件，这时候才调用回调函数。</li>
<li>创建一个模块时，id就是模块的地址，通过创建 script 标签的方式异步加载模块的代码（factory），factory 加载完成后，会 check factory 中有没有 require 别的子模块:<ul>
<li>如果有，继续加载其子模块，并在子模块上绑定 “complete” 事件，来触发本身 的 “complete” 事件；</li>
<li>如果没有则直接触发本身的 “complete” 事件。</li>
</ul>
</li>
<li>如果子模块中还有依赖，则会递归这个过程。</li>
<li>通过事件由里到外的传递，当所有依赖的模块都 complete 的时候，最外层的入口模块才会触发 “complete” 事件，use 方法中的回调函数才会被调用。</li>
</ol>
        
          <p class="article-more-link">
            <a href="/how-to-realize-cmd-loader/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://annn.me/how-to-realize-cmd-loader/" data-id="cjf2fw25z0031hwf59m6flued" data-title="如何实现一个 CMD 模块加载器" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/cmd/">cmd</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/loader/">loader</a></li></ul>

    </footer>
  </div>
  
</article>


  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  

</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 阿安<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/categories" class="mobile-nav-link">分类</a>
  
    <a href="/tags" class="mobile-nav-link">标签</a>
  
    <a href="/links" class="mobile-nav-link">链接</a>
  
    <a href="https://500px.com/annnhan" class="mobile-nav-link">摄影</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
</nav>
    

<!--<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>-->

<script src="/js/libs/jquery.2.0.3.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>